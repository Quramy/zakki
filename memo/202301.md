# 1/4

## Prisma

jest-prisma と prisma-fabbrica の記事（英語版）をそれぞれ Medium に公開した。

- https://quramy.medium.com/test-your-prisma-app-part-1-isolated-transactional-testing-via-jest-prisma-14075c14b2ea
- https://quramy.medium.com/test-your-prisma-app-part-2-prisma-fabbrica-test-data-factory-utility-89f8f4c36302

---

# 1/6

## T3

そろそろ真面目に一回 T3 Stack 触っておくか、という気持ちになってきた。

https://create.t3.gg/

---

# 1/11

## Rails

前から気になっていた「Active Job に直接 Active Record のインスタンスが渡せるのかどうか」について、以下の記事がわかりやすかった。

https://zenn.dev/stomk/articles/11f8c0dba0303://zenn.dev/stomk/articles/11f8c0dba0303e

## Puma

Puma を運用している中で「web サーバが起動した後」というコールバックが欲しくなることがまれにある。

Cluster Mode であれば、 Puma DSL の `after_worker_boot` に書けばよいが、Single Mode だとこのコールバックは使えなくて困っていたが、 Puma のコードを読んでいたところ、`on_booted` という Event を発火させていることがわかった。

https://github.com/puma/puma/blob/97ec2484b1d8664c73a250c2cec2c8fe736ba271/lib/puma/single.rb#L58

DSL から直接このイベントを引っ掛けられるわけではないが、 `launcher.events` が使えるので、自前で Puma Plugin を用意することで `on_booted` が利用できる。

```ruby
# lib/puma/plugin/my_plugin.rb

Puma::Plugin.create do
  def start(launcher)
    launcher.events.on_booted do
      puts "Puma gets on booted."
    end
  end
end
```

```ruby
# config/puma.rb

require './lib/puma/plugin/my_plugin'

plugin :my_plugin
```

## T3

とりあえず zod を触りだしてみたものの、簡単すぎて語ることが全然ない。

tRPC について、思想的な部分が分かるリソースを探す。

まずは Theo の tRPC v.s. GraphQL についての動画。
https://www.youtube.com/watch?v=KIJUUtWjl48

tRPC は backend の関数を frontend に公開するための仕組みでしかない。
GraphQL の Schema は backend - frontend の Conract としての側面があるが、tRPC は Schema を整備することそれ自体を目的にしない。
同じチームの中で一透過的に HTTP 越しに TypeScript の非同期関数を呼び出したいだけ。

---

# 1/12

## JavaScript

https://2022.stateofjs.com/en-US/

## RDS

AWS の RDS Performance Insights の使い方を学んだ。

Datadog や New Relic だと、相当の設定を仕込まないと ORM Duration の内訳まではわからないが、 Perf Insights 単独で wait の内訳が可視化できるため、特に Slow Query 調査には有用。

Metrics も幾つかついてくるが、直近で役に立ったのは下記辺り。

- Dead lock 発生有無
- Active transactions
- Blocked transactions

---

# 1/13

## Safari

https://webkit.org/blog/13686/release-notes-for-safari-technology-preview-161/

> Added experimental support for AudioSession Web API

上記が新しく追加されるらしいという話を社内で聞いた
