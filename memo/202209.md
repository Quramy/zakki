# 9/1

## Unix

仕事で BigQuery から CSV を引っこ抜いてきて、別の CSV と突き合わせて諸々調査する、というのをやっていたのだが、最終的なスクリプトに食わせる中間的な操作はコマンドだけで済ませたいく、頻繁に使えそうなものをピックアップしてみた。

ヘッダ行の退避:

```sh
head -n 1 raw.csv > header.csv
```

データ部分の取り出し:

```sh
tail -n +2 raw.csv > data.csv
```

処理したデータとヘッダ行の結合

```sh
cat processed_data.csv | cat header.csv -
```

2 列目を辞書順でソート:

```sh
sort -t, -k2 data.csv
```

3 列目を数値順でソート:

```sh
sort -t, -k3n data.csv
```

2 列目を辞書順、さらにその中で 3 列目を数値順でソート:

```sh
sort -t, -k2,2 -k3n,3 data.csv
```

4 列目のみを取り出し:

```sh
cut -d, -f 4 raw.csv
```

1 列目と 3 列目を取り出し:

```sh
cut -d, -f 1,3 raw.csv
```

4 列目を重複排除して表示:

```sh
sort -t, -k4 raw.csv | cut -d, -f 4 | uniq | cat -n
```

4 列目を重複排除した数を取得:

```sh
sort -t, -k4 raw.csv | cut -d, -f 4 | grep -v "^$" | uniq | wc -l
```
