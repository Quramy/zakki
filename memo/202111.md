# 11/1

## GraphQL

v16 が出てた。Spec としては 2018 以来とあって流石に Breaking Change も多い。。。

https://github.com/graphql/graphql-js/releases/v16.0.0

## Misc

同僚に https://github.com/microsoft/typescript-styled-plugin が僕の ts-graphql-plugin 由来と教わって驚く。

確かに、

> Code originally forked from: https://github.com/Quramy/ts-graphql-plugin

https://github.com/microsoft/typescript-styled-plugin/blob/main/LICENSE.txt にも

```
Copyright (c) base project [2017] [Quramy], Modifications copyright Microsoft 2017
```

とあった。 4 年越しに知るなんて。

---

# 11/2

## Storybook

いつも忘れるんだけど、Storybook における環境変数の件。

環境変数を伝播させるには `STORYBOOK` prefix を付与する必要がある。

```sh
STORYBOOK_HOGE_FUGA=TRUE start-storybook
```

```js
if (process.env.STORYBOOK_HOGE_FUGA === "TRUE") {
  // Something
}
```

ちなみに、JS/TS 以外にも CSS/HTML で直接文字列置換することもできる。

```html
<!-- preview-head.html -->

<base href="%STORYBOOK_BASE_HREF%" />
```

---

# 11/4

## react-query

API 共通で Error Handling を行いたい場合、 `QueryClient` を生成する際に、それぞれの Cache に Error Handler を仕掛けることができる。

```tsx
function App() {
  const queryClient = new QueryClient({
    queryCache: new QueryCache({
      onError: error => {
        // handle error
      }
    }),
    mutationCache: new MutationCache({
      onError: error => {
        // handle error
      }
    })
  });
  return (
    <QueryClientProvider client={queryClient}>
      <MyApp />
    </QueryClientProvider>
  );
}
```

ただ、これって

```ts
const { data, error } = useQuery(/* keyとか */);
```

で error を補足する・しないとは関係なく起こるのだろうし、 Error Boundary と違って、Try Catch のような感覚で使えるような代物じゃないように見えるので使い所が難しそう。
