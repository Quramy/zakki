# 8/2

## 外部登壇

@takepepe さんと一緒に https://findy.connpass.com/event/290730/ のイベントでフロントのテストについて色々喋ってきた。

コメントの中で「App Router のテストが気になる」と書いていた方がいたのがタイムリー。

## React.js

上記の「APp Router のテストが〜」に関係するかもであるが、SC から DOM までの Integrated なテストについて、現状ではこれを実現する術がない。

たまたま、 @uhyo さんも今日に別の場で SC について語っていて、この件にも資料で触れていたようである。

https://speakerdeck.com/uhyo/app-routershi-dai-nodetaqu-de-akitekutiya?slide=50

https://github.com/testing-library/react-testing-library/issues/1209#issuecomment-1599353532 で Sebastian Markbåge が書いているが、事の本質は RSC は「Server で動作する Component」と「Client で動作する Component」が明示的かつ排他的に分離されていることだと思う。

これが「jest の test suite は、何かしらの environment で動かす」に対して相性が悪い。

現状では、以下のように単体テスト x2 で書くのが現実的だと思う。

- SC における非同期関数部分: jest-environment-node
- SC から呼び出されるレンダリング部分: jest-environment-jsdom + `@testing-library/react`

https://github.com/Quramy/server-components-with-container-presentation の repo にその骨子を書いた
