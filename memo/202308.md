# 8/2

## 外部登壇

@takepepe さんと一緒に https://findy.connpass.com/event/290730/ のイベントでフロントのテストについて色々喋ってきた。

コメントの中で「App Router のテストが気になる」と書いていた方がいたのがタイムリー。

## React.js

上記の「App Router のテストが〜」に関係するかもであるが、SC から DOM までの Integrated なテストについて、現状ではこれを実現する術がない。

たまたま、 @uhyo さんも今日に別の場で SC について語っていて、この件にも資料で触れていたようである。

https://speakerdeck.com/uhyo/app-routershi-dai-nodetaqu-de-akitekutiya?slide=50

https://github.com/testing-library/react-testing-library/issues/1209#issuecomment-1599353532 で Sebastian Markbåge が書いているが、事の本質は RSC は「Server で動作する Component」と「Client で動作する Component」が明示的かつ排他的に分離されていることだと思う。

これが「jest の test suite は、何かしらの environment で動かす」に対して相性が悪い。

現状では、以下のように単体テスト x2 で書くのが現実的だと思う。

- SC における非同期関数部分: jest-environment-node
- SC から呼び出されるレンダリング部分: jest-environment-jsdom + `@testing-library/react`

https://github.com/Quramy/server-components-with-container-presentation の repo にその骨子を書いた

---

# 8/3

## CSS

元々は `leading-trim` とか `text-edge` という property で策定されていた、CSS Inline module 系が命名変わっていた。

https://caniuse.com/css-text-box-trim

https://github.com/w3c/csswg-drafts/issues/8479 の辺りを読めば、変更経緯とか追えるかな？と思ったものの、全然ついていけずに挫折。。。

---

# 8/6

## Misc

2023-08-05 分について、GitHub への push を忘れてついに Streak が途切れてしまった。悲しい。

---

# 8/7

## CSS

以下を使うと、円形にそったグラデーションを持ったローディングアイコンを作れる。

- https://developer.mozilla.org/ja/docs/Web/CSS/clip-path
- https://developer.mozilla.org/ja/docs/Web/CSS/gradient/conic-gradient

## Misc

SC のテストの件について、Medium にまとめた。

https://quramy.medium.com/react-server-component-%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88%E3%81%A8-container-presentation-separation-7da455d66576

---

# 8/8

## CSS

存在を忘れてしまっていた `object-fit`

https://developer.mozilla.org/ja/docs/Web/CSS/object-fit

## Stylelint

CSS Modules での緩め Stylelint 設定はこんな感じかな、というものを雑に作ったのでメモ.

```yml
extends:
  - stylelint-config-standard

rules:
  # CSS Modules
  selector-class-pattern:
    - "^([a-z][a-zA-Z0-9]*)$"
    - message: "to be camelCase"

  # CSS Modules, to avoid conflict class name and animation name
  keyframes-name-pattern:
    - "^([a-z][a-zA-Z0-9]*)Animation$"
    - message: "should end with 'Animation' suffix"

  unit-disallowed-list:
    - - "cm"
      - "mm"
      - "Q"
      - "in"
      - "pc"
      - "pt"
      - "rem" # Opnionated
      - "vh" # Prefer dvh
      - "vw" # Prefer dvh

  # Enforce no-unit line-height
  declaration-property-unit-disallowed-list:
    "line-height":
      - "px"
      - "em"
      - "%"
```

## Vim

ALE + Stylelint の設定を行った。

ついでに ALE が virtual text message などのあまり好きではない見た目をカスタマイズ。

---

# 8/9

## CSS

`:has` 擬似クラスセレクタ、とっくに Production Ready なレベルかと誤解していたが、Android Chrome では v115(shipped 2023/07/25) でようやく使えるようになる程度だった。

https://caniuse.com/css-has

よくよく確認してみたら、interop 2023 にも組み込まれている。

https://web.dev/interop-2023/#has

たまたま昨日に Stylelint のことを考えていたので、これに関連すると、特定の疑似クラスセレクタを ban するには https://stylelint.io/user-guide/rules/selector-pseudo-class-disallowed-list を使えばいい。

## VSC

複数のテキストブロックを折り畳めるようにする際、Vim だと fold-marker の `{{{` と `}}}` をコメントとして書くことが稀によくある。

```yml
# {{{ なにかのブロック
hoge:
  - a
  - b
fuga:
  - c
  - d
# }}}
```

とはいえこれって VSC ユーザーにはまったく優しさがないので、仕事では利用を避けていたのだけど、`region` と `endregion` も併せて使えばどちらにも優しい。

```yml
# region なにかのブロック {{{
hoge:
  - a
  - b
fuga:
  - c
  - d
# enderegion }}}
```
