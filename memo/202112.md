# 12/1

## Storybook

昨日に引き続き、CSF 3.0 や Storybook 6.4 周りを触っていく。

@sangotaro さんと話しているなかで、いつのまにか Story title が自動生成されるようになっていたことを知る。

基本的には .stories ファイルが存在しているディレクトリ名で決定される。

`components/Hoge/index.stories.tsx` であれば、`Components/Hoge/Index` みたいなイメージ。

一定の naming rule で決定されるのは便利そうではあるが、`Index` とか付けてほしくないし、、、というのを考えるとまだ微妙かも。

## Firebase

久々に Firebase の Client 側 SDK にふれる。今回の目的は Analytics を触ってみること。結局のところ、GA の js と同じものが動いているだけっぽいんだけど、Firebase 側で Measurement されたイベントを上手く見れない。設定間違ってんのか。。。？

よくよく考えると、WACUL 退職して結構経つし、もう随分 GA 触ってなかったんだなーということに気づいた。

---

# 12/2

## reg

メンバーがアドカレに書いてくれた。普通に嬉しい。

https://qiita.com/sakamuuy/items/44a109532f06e0b619e3

reg-suit ではなく、 reg-cli を使ったパターンで、Repository に Snapshot 保持する系統なんだけど、面倒な Snapshot Update を GH Action で上手くやっているパターン

```yaml
name: Update snapshot
on:
  pull_request:
    types:
      - labeled
jobs:
  update-vrt-snapshot:
    if: contains(github.event.pull_request.labels.*.name, 'update-snapshots')
    steps:
      -  #以下略
```

## Misc

昨日の Firebase Analytics の件。1 日経った後に確認したところ、送信した event がちゃんと溜まっていた。

---

# 12/3

## reg

GH Actions のみで reg-suit っぽいことができるのか問題を久々に考える。

1. expected(= image snapshot) は Repository に直接配置
1. actual と結果の json をその repository の wiki に push
1. Report UI の SPA を別のどこかに Deploy しておく

1.は昨日の @sakamuuy の記事にあるような方法で問題ない。 2.は @gfx さんの https://gfx.hatenablog.com/entry/2021/07/04/202004 という記事を見る限り普通にできそう。

また、wiki に push した画像や JSON も https://raw.githubusercontent.com/wiki/Quramy/wiki-sandbox-testing/temp/hoge/result.json のような URL で DL できるし、何なら CORS でアクセスできる。

ということはだ、3.の URL を仮に `https://diff-report.reg-viz.net` としておいて、そこに 2.で deploy した json の URL を食わせるとする。

`https://diff-report.reg-viz.net/?result_url=https%3A%2F%2Fraw.githubusercontent.com%2Fwiki%2FQuramy%2Fwiki-sandbox-testing%2Ftemp%2Fhoge%2Fresult.json`

最初に JSON を fetch してくれば、後はいつもの Report UI と一緒にできるかも。

---

# 12/5

## Misc

ひぃひぃ言いながらアドカレ 2 本書ききる。疲れた。。。

---

# 12/6

## PicoML

アドカレについて、@blackenedgold さんとかに捕捉されてたのは地味に嬉しい...!

https://twitter.com/blackenedgold/status/1467736749766225920

---

# 12/7

## HTTP

HTTP のレスポンスヘッダの `Content-Disposition` というものの存在を知る。

https://developer.mozilla.org/ja/docs/Web/HTTP/Headers/Content-Disposition

UA に直接ファイルを開かせるのか、それとも保存させるのかを指定できる。 RFC の番号的に結構古いっぽい。。。？

https://datatracker.ietf.org/doc/html/rfc2183

似たような用途で利用されそうなのが、a タグの `download` 属性。

```html
<a href="doc.pdf" download="doc.pdf" />
```

https://developer.mozilla.org/ja/docs/Web/HTML/Element/a#attr-download

ただ、こちらは Same Origin でないと無視される。

「インラインで開くようにしたい」「ダウンロードされるようにしたい」っていうの、割とよく言われるんだけど、どれがいいんだろうな。。。

---

# 12/8

## 読書

先日推薦された Team Topologies の物理本が手元に届いたので読み始める。

一章を読み終えたところだが、「組織設計を見直せ(= 静的に確定するものと思うな)」「チームの認知負荷にバジェットがあると考えろ」という説が個人的に目新しさを覚えた。一方、「アーキテクチャを見据えて組織を考えろ(= 逆コンウェイ則)」などは他でも見聞きしたことのある部分。

---

# 12/9

## react-query

React Query v4 の初版が出ている模様。

https://github.com/tannerlinsley/react-query/releases/tag/v4.0.0-alpha.1
