# 2/1

## Puppeteer

業務で作ってるちょっとした Webview 画面の HTML について、Puppeteer オンリーでテストコードを記述する、というのをやってみた。

そもそも自動テスト書くほど機能が豊富なページではないんだけど、半分くらいは暇だったので書いてみた、というのに近い。

昨年末に Medium に書いた ARIA ハンドラを実際に HTML のテストに組み込んでみたかった、というのもある。

例えば下記のような感じ。

```js
async testPage(page) {
  const inputHandle = await page.$('aria/ユーザー名[role="textbox"]')

  assert.equal(await inputHandle.evaluate(elm => elm.type), 'email')
  assert.equal(await inputHandle.evaluate(elm => elm.maxLength), 40)
}
```

ついでにというか、ARIA ハンドラとは全然関係ないが、既存の Element Handle から、新しく別の要素の Element Handle を作ろうとして、

```js
const newHandle = await someElementHandle.evaluate(
  node => node.nextElementSibling
);
```

のように書いたら全然動かなくて 10 分くらいハマってた。正しくは `evaluateHandle` を使う。

```js
const newHandle = await someElementHandle.evaluateHandle(
  node => node.nextElementSibling
);
```

## Misc

薄々分かってはいたんだけど、1 月、全然 input も自発的な勉強もしてなかったのが memo の量からも一目瞭然だ。自覚はあったけど、実際に昨年の 12 月分と比較すると記載量としてもボリュームめちゃめちゃ少ないもんな。。。別に量を書くことが目的じゃないけど、流石に何もしてなさすぎて危機感出るわ。
