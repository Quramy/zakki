# 4/1

## prisma-fabbrica ã® bug fix

ä¹…ã€…ã« PR æ¥ã¦ã„ãŸã®ã§ merged

https://github.com/Quramy/prisma-fabbrica/pull/451

## Postmortem on Next.js Middleware bypass

Next.js ã®å…¬å¼ãƒ–ãƒ­ã‚°ã«ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ãŒä¸ŠãŒã£ã¦ã„ãŸã®ã§èª­ã‚“ã ã€‚

https://vercel.com/blog/postmortem-on-next-js-middleware-bypass

ä»¶ã®ãƒ˜ãƒƒãƒ€ã‚’åˆ©ç”¨ã—ã¦ã„ãŸç†ç”±ã¨ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ãŒã€ã“ã†ã„ã†ã®ã£ã¦æ°—ä»˜ã‘ãªã„ã‚‚ã®ãªã®ã‹ã­ã‡ã€‚ã€‚

> Next.js uses an internal x-middleware-subrequest header to detect and prevent recursion
> Middleware happens separately from the rendering process of a page.
> Because of the Middleware running in a separate process, we had to leverage an internal header to signal to the routing process that the Middleware had already run when doing a fetch to the app from inside the Middleware.

èµ·ãã¦ã‹ã‚‰ã€ã€Œãã‚Œäº‹å‰ã«ã‚ã‹ã‚‰ãªã‹ã£ãŸã®ï¼Ÿã€ã¨ä¸Šã‹ã‚‰è¨€ã†ã®ã¯ç°¡å˜ã ã‘ã©ã€ã˜ã‚ƒãè‡ªåˆ†ãŒåŒã˜ç«‹å ´ã ã£ãŸã¨ã—ã¦ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚„è¨­è¨ˆæ®µéšã§æ°—ã¥ã‘ãŸã‹ã£ã¦ãƒ¼ã¨éå¸¸ã«æ€ªã—ã„ã‚‚ã‚“ã ã—ãªã€‚ã€‚

## ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã®å®Ÿè£…ã«ä¾¿åˆ©ãª CSS properties

Chrome ã® v135 ã«ä½µã›ã¦ã€å¹¾ã¤ã‹ä¾¿åˆ©ãª Properties ã‚„ç–‘ä¼¼è¦ç´ ã‚»ãƒ¬ã‚¯ã‚¿ãŒè§£ç¦ã•ã‚ŒãŸã‚ˆã€ã¨ã„ã†è©±ã€‚

https://developer.chrome.com/blog/carousels-with-css

```css
.carousel {
  /* ... */

  &::scroll-button(left) {
    content: "â¬…" / "Scroll Left";
  }

  &::scroll-button(right) {
    content: "â®•" / "Scroll Right";
  }

  &::scroll-button(*)::focus-visible {
    outline-offset: 5px;
  }
}
```

```css
.carousel {
  /* ... */

  scroll-marker-group: after;

  > li::scroll-marker {
    content: " ";

    &:target-current {
      background: var(--accent);
    }
  }
}
```

Spec ã§ã„ã†ã¨ https://drafts.csswg.org/css-overflow-5/#scroll-navigation è¾ºã‚Š

ï¼‘å¹´åŠã»ã©å‰ã«ã€ã¾ã•ã«ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã‚’å®Ÿç¾ã™ã‚‹æ©Ÿä¼šãŒã‚ã£ãŸãŒã€ã“ã® `::scroll-marker` éƒ¨åˆ†ã¯è«¦ã‚ã¦ JavaScript ã§é€ƒã’ãŸè¨˜æ†¶ã€‚

---

# 4/8

## ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®å†…éƒ¨å®Ÿè£…ã«æ€ã„ã‚’é¦³ã›ã‚‹

åŒåƒšã¨ä¼šè©±ã—ã¦ã„ãŸæœ€ä¸­ã«ã€ ä¸€ç¬ Web Readable Stream ã® `.tee` ãƒ¡ã‚½ãƒƒãƒ‰ã®è©±é¡Œã«ãªã£ãŸã€‚

`.tee` ã§ Stream ã‚’åˆ†å²ã•ã›ãŸå ´åˆã«ã€å†…éƒ¨ã®ãƒªã‚½ãƒ¼ã‚¹(ãƒ¡ãƒ¢ãƒª) æ¶ˆè²»ã¯ã©ã†ãªã‚‹ã‚“ã ã‚ã†ï¼Ÿã¨æ€ã£ãŸãŒã€ã‚ˆãã‚ˆãè€ƒãˆãŸã‚‰ãã†é›£ã—ã„è©±ã§ã‚‚ãªã„æ°—ãŒã™ã‚‹ã€‚

å¤šåˆ†ã ãŒã€Readable ã‚„ Transform ã¯ Underlying Sink ã¨ã—ã¦ Queue ãƒ©ã‚¤ã‚¯ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ä¿æŒã—ã¦ã„ã‚‹ã®ã ã¨æ€ã†ã€‚
`ctrl.enqueue` ã§ Queue ã®æœ«å°¾ã«ãƒ‡ãƒ¼ã‚¿ãŒè©°ã‚ã‚‰ã‚Œã€`.read()` ã§ Queue ã®å…ˆé ­ã®ãƒ‡ãƒ¼ã‚¿ãŒãƒãƒƒãƒ—ã•ã‚Œã‚‹ã€‚
åŸå‰‡çš„ã«è€ƒãˆã‚‹ã¨ã€Chunk ãŒãƒãƒƒãƒ—ã•ã‚ŒãŸã‚‰ãã®ãƒãƒ£ãƒ³ã‚¯ã«å¯¾ã™ã‚‹ Queue ã‹ã‚‰ã®å‚ç…§ã¯è§£æ”¾ã•ã‚Œã¦ã„ã‚‹ã¹ããªã¯ãšã€‚

ã‚“ã§ã€ `.tee` ã£ã¦è¦ã¯ã“ã® Underlying ã® Queue ã‚’è¤‡è£½ã—ã¦ã„ã‚‹ã®ã¨åŒã˜ã§ã¯ã€‚

ãã†ã„ãˆã°ã€RxJS ã‚’ã‚„ã£ã¦ã„ãŸã“ã‚ã€`Subscription` ã ã‹ `Observable` ã«å¯¾ã—ã¦ Hot ã ã® Cold ã ã®ã¨ã„ã†è¨€è‘‰ãŒã‚ã£ãŸã‚ˆã†ãªã€‚ã€‚ã€‚ã€‚

ã¨æ€ã£ã¦ä¹…ã€…ã« Rx ã® docs ã‚’è¦‹ã«è¡Œã£ãŸã‚‰ã€è‡ªåˆ†ãŒæ€ã„æã„ã¦ã„ãŸã®ã¯ Unicast or Multicast ã ã£ãŸã€‚Cold ãª Observable ãŒçµæœã¨ã—ã¦ Unicast ã«ãªã‚‹ã€ã¨ã„ã†ã“ã¨ã ã£ãŸ( Unicast ãª Observable ãŒå¿…ãšã—ã‚‚ Cold ã¨ã¯é™ã‚‰ãªã„)

- https://rxjs.dev/guide/glossary-and-semantics#unicast
- https://rxjs.dev/guide/glossary-and-semantics#cold

## Angular docs ã‚’ä¹…ã€…ã«çœºã‚ã‚‹

RxJS ã®ã“ã¨ã‚’æ€ã„å‡ºã—ãŸä¹…ã€…ã¤ãªãŒã‚Šã¨ã„ã†ã“ã¨ã§ã€Angular dev ã‚’è¦—ã„ã¦ã¿ã‚‹ã€‚

https://angular.dev

Signal ãŒåˆ©ç”¨å¯èƒ½ã«ãªã£ãŸã€ã¨ã„ã†ã“ã¨è‡ªä½“ã¯éšåˆ†å‰ã«èã„ã¦ã¯ã„ãŸã‚‚ã®ã®ã€ä»Šã‚„å®Œå…¨ã« Angular ã®ä¸­å¿ƒã«ãªã£ã¦ã„ã‚‹æ„Ÿã˜ãªã®ã­ã€‚ã€‚
ã‚ˆãã‚ˆãè€ƒãˆã‚‹ã¨ã‚‚ã†ï¼–ã€œï¼—å¹´ãã‚‰ã„æ›¸ã„ã¦ãªã„ã‚‚ã‚“ãªãƒ¼ã€‚ãã‚Šã‚ƒè‰²ã€…ã¨å¤‰ã‚ã‚‹ã‚ã€‚

[Angular 2025 Strategy](https://blog.angular.dev/angular-2025-strategy-9ca333dfc334) ã‚’èª­ã‚ã°ã€ç›´è¿‘ã® Core ãƒãƒ¼ãƒ ã®æ³¨è¦–é ˜åŸŸãŒã‚ã‹ã‚Šãã†ã€‚
(Zoneless ãŒã‚ˆã†ã‚„ãæ¥ãã†ã€ã¨ã„ã†éƒ¨åˆ†ã ã‘èª­ã‚“ã )

---

# 4/11

## Apollo Client + Next.js Integration ã®æ­£å¼ãƒªãƒªãƒ¼ã‚¹

https://www.apollographql.com/blog/apollo-client-integration-nextjs-officially-released

è¨˜äº‹ã«ã¯ãªã«ã‚‚æ›¸ã„ã¦ãªã„ã‘ã©ã€CSR ã™ã‚‹ã¨ãã¯ã©ã†ã„ã†æŒ™å‹•ã«ãªã‚‹ã‚“ã ã‚ã† :thinking:
Preload Query ä¸­å¿ƒã«ã™ã‚‹ã¨ã„ã†ã“ã¨ã¯ã€react-router ã® client loader çš„ã« Preload Query ã®ãƒ‡ãƒ¼ã‚¿ã ã‘ã‚’å–ã£ã¦ãã‚‹ã‚ˆã†ãªå½¢ã«ãªã‚‹ã‚“ã ã‚ã†ã‘ã©ã€App Router ã§ãã‚Œç°¡å˜ã«ã§ãã‚‹ã‚“ã ã£ã‘ï¼Ÿã¨ã„ã†è¾ºã‚Šã€‚

ä½•ã‹ Demo App ã¿ãŸã„ã®ä½œã£ã¦ã€å®Ÿéš›ã«æŒ™å‹•è¿½ã£ã¦ã¿ãªã„ã¨é ­ã®æ•´ç†ãŒè¿½ã„ã¤ã‹ãªã„ãªã€‚

---

# 4/15

## CSS ã® `animation` property

ä½•åº¦æ›¸ã„ã¦ã‚‚ã€`animation` shorthand ã®é †ç•ªãŒè¦šãˆã‚‰ã‚Œãªã„ã€‚

https://developer.mozilla.org/ja/docs/Web/CSS/animation

```css
.container {
  animation: 1sec ease-in-out slide-in;
}

.container {
  animation: 1sec linear 0 infinite spinning;
}

.container {
  animation: 1sec ease-in 0 infinite alternate fade-in;
}
```

ç‰¹ã« iteration-count ã¨ direction ã®è¾ºã‚Šã€‚

---

# 4/16

## Next.js ã® gIP ã¨ Custom Error / 500.tsx

Pages Router ã§ã®è©±ã ãŒã€ ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆã«ãªã£ã¦ã„ã‚‹å ´åˆã«ã€index.js ã® SSR ä¸­ã« Error ã‚’ã¶ã‚“æŠ•ã’ãŸå ´åˆã«ä¸å¯æ€è­°ãªæŒ™å‹•ã‚’å–ã‚‹

```
pages/
  _app.js
  _error.js
  500.js
  index.js
```

https://nextjs.org/docs/pages/building-your-application/routing/custom-error#more-advanced-error-page-customizing ã«ä»¥ä¸‹ã®ã‚ˆã†ã«è¨˜è¼‰ãŒã‚ã‚‹ãŸã‚ã€500.js ãŒç„¡è¦–ã•ã‚Œã¦ `_error.js` ã®æ–¹ã®ã¿ Render ã•ã‚Œã‚‹ã¨æ€ã£ã¦ã„ãŸãŒã€ã©ã†ã‚‚ãã†ã§ã¯ãªã„

> If you wish to override it, define the file pages/\_error.js and add the following code

å®Ÿéš›ã¯ä»¥ä¸‹ã®é †åºã§å‹•ä½œã™ã‚‹:

1. `index.js` <-- ã“ã“ã§ Render Error
2. `_error.js`
3. `500.js`

[å®Ÿè£…](https://github.com/vercel/next.js/blob/v15.3.0/packages/next/src/server/base-server.ts#L3859-L3883) ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€ç¢ºã‹ã« 500 page ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ `renderErrorToResponse` ãŒè¨ˆ 2 å›å‘¼ã³å‡ºã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã¯ç¢ºèªã§ããŸãŒã€`renderErrorToResponse` ã®å®Ÿä½“ãŒèª­ã¿ã«ãã™ãã¦ã“ã‚Œä»¥ä¸Šè¿½ã†æ°—æŒã¡ã«ãªã‚Œãªã„ã€‚

```
      // if pages/500 is present we still need to trigger
      // /_error `getInitialProps` to allow reporting error
      if (await this.hasPage('/500')) {
        addRequestMeta(ctx.req, 'customErrorRender', true)
        await this.renderErrorToResponse(ctx, err)
        removeRequestMeta(ctx.req, 'customErrorRender')
      }

      const isWrappedError = err instanceof WrappedBuildError

      if (!isWrappedError) {
        if (
          (this.minimalMode && process.env.NEXT_RUNTIME !== 'edge') ||
          this.renderOpts.dev
        ) {
          if (isError(err)) err.page = page
          throw err
        }
        this.logError(getProperError(err))
      }
      const response = await this.renderErrorToResponse(
        ctx,
        isWrappedError ? (err as WrappedBuildError).innerError : err
      )
      return response
```

## React ã® `Activity` Component

ä»¥å‰ `Offccreen` ã¨å‘¼ã°ã‚Œã¦ã„ãŸ Component ãŒ `Activity` ã«æ”¹ç§°ã•ã‚Œã¦ã„ãŸã®ã‚’ä»Šæ›´ãªãŒã‚‰ã«çŸ¥ã£ãŸã€‚
ã¨ã„ã†ã‹ã€ãªã‚“ãªã‚‰ `Offscreen` Component ã™ã‚‰èªè­˜ã—ã¦ã„ãªã‹ã£ãŸã€‚

- https://react.dev/blog/2023/03/22/react-labs-what-we-have-been-working-on-march-2023#offscreen-rendering
- https://react.dev/blog/2024/02/15/react-labs-what-we-have-been-working-on-february-2024#offscreen-renamed-to-activity

"Offscreen" ã¨ã„ã†åå‰ã ã¨æ¯”è¼ƒçš„ã‚¤ãƒ¡ãƒ¼ã‚¸ã—ã‚„ã™ã„ãŒã€ãªã‚“ã‚„ã‹ã‚“ã‚„ã‚ã£ã¦ `Activity` ã«æ”¹ç§°ã•ã‚ŒãŸã‚‰ã—ã„(ã“ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚‚é•·ã„...)

https://github.com/facebook/react/pull/27640#issuecomment-1801185861

ã€ŒCSS ã® `content-visibility` ã®ã‚ˆã†ãªã‚‚ã®ã€ã¨ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹ã‘ã©ã€å®Ÿéš›ã¯ã©ã†ã‚„ã£ã¦å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã®ã ã‚ã†ï¼Ÿ

react-dom ã¨ã„ã†ã‚ˆã‚Šã‚‚ Fiber ã§ State å€¤ã®ä¿æŒãªã©ã‚’ç‰¹åˆ¥ã«(= å¾Œã‹ã‚‰å†åˆ©ç”¨å¯èƒ½ãªã‚ˆã†ã«) é ‘å¼µã£ã¦ã„ã‚‹ã ã‘ã§ã€ä¾‹ãˆã° Offscreen ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹å ´åˆã¯ DOM ã®ãƒ¬ã‚¤ãƒ¤ã§ã¯é€šå¸¸ã® Commit ãŒè¡Œã‚ã‚Œã‚‹ã‚“ã ã‚ã†ã‹ï¼Ÿ

ä¸Šè¨˜ã® Dan Abramov ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å‘¼ã‚“ã æ„Ÿã˜ã€ä»Šå¾Œã¯å®Ÿè£…ã¨ã—ã¦ã‚‚ CSS ã® `content-visibility` ã‚’ä½¿ã†ã‚ˆã†ã«å¤‰æ›´ã•ã‚Œã‚‹ã®ã‹ã‚‚ã—ã‚Œãªã„ã€‚

ãã‚‚ãã‚‚ CSS ã® `content-visibility` ã¨ `visibility` ã®é•ã„ã™ã‚‰ã†ã‚è¦šãˆãªã®ã§ã€ã“ã®è¾ºã‚Šã¯å…¨èˆ¬çš„ã«èª¿ã¹ç›´ã•ãªã„ã¨ãªãã€‚ã€‚ã€‚

---

# 4/21

## Java ã«ãŠã‘ã‚‹ `Optional`

https://zenn.dev/ayumukob/articles/552d0c7b544838

ä»¥ä¸‹ã®ã‚ˆã†ã«æ‰±ãˆã‚‹ã€ã¨ã„ã†ã“ã¨ã‚‰ã—ã„ã‚“ã ãŒã€ã€ã€

```java
Optional.ofNullable(hoge).map(hoge -> new Foo(hoge.piyo)).orElse(new Foo(null));
```

ãã‚‚ãã‚‚ `hoge` ãŒ Nullable ã§ã‚ã‚‹ã“ã¨ã‚’çŸ¥ã‚‰ãªã„ã¨ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã«ãŸã©ã‚Šç€ã‹ãªã„ã®ã§ã¯ï¼Ÿã¨ã„ã†ã€‚

---

# 4/24

## React View Transition ã¨ Activity

https://react.dev/blog/2025/04/23/react-labs-view-transitions-activity-and-more

View Transition ã¨ Activity ãŒå¤§ããå–ã‚Šä¸Šã’ã‚‰ã‚Œã¦ã„ã¦ã€ã¡ã‚‡ã†ã©å€‹äººçš„ã«æ°—ã«ãªã£ã¦ã„ãŸã¨ã“ã‚ã ã£ãŸã€‚

Docs ã«ã‚‚ [åŒã˜ã‚¿ã‚¤ãƒŸãƒ³ã‚°](https://github.com/reactjs/react.dev/pull/7772) ã§è¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã€‚

- https://react.dev/reference/react/Activity
- https://react.dev/reference/react/ViewTransition

### Activity

ã€ŒActivity (Offscreen) ã¯ hidden ã®ã¨ãã«ã©ã®ã‚ˆã†ãªçŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹ã‹ï¼Ÿã€ãŒç–‘å•ã ã£ãŸã‚ã‘ã ãŒã€ã€ŒDOM ã®çŠ¶æ…‹ã¯ä¿æŒã•ã‚Œã‚‹ã€ã¨æ›¸ã‹ã‚Œã¦ã„ã‚‹ã€‚

> When an Activity switches from mode="visible" to â€œhiddenâ€, the children will become hidden on the page, and unmount by destroying all Effects, but will keep their React and DOM state.

æ‰‹å…ƒã§è»½ã Activity ã®å‹•ãã‚’ç¢ºèªã—ã¦ã¿ãŸã¨ã“ã‚ã€ `mode` å€¤ãŒ visible -> hidden ã¨ãªã£ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã‚‚ã€Activity ã® Children ã¯ DOM ãƒ„ãƒªãƒ¼ä¸Šã¯è¦ª DOM (ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§ã„ã†ã¨ `<main>` è¦ç´ ) ã«ã¶ã‚‰ä¸‹ãŒã£ãŸã¾ã¾ã€è¦ç´ ã® style ã« `{ display: none !important }` ãŒè¿½åŠ ã•ã‚Œã¦ã„ãŸã€‚

```tsx
"use client";

import { useState, unstable_Activity as Activity } from "react";
import { Swatch } from "../_components";

export default function Page() {
  const [mode, setMode] = useState<"hidden" | "visible">("hidden");
  return (
    <main>
      <button
        onClick={() => {
          if (mode === "hidden") {
            setMode("visible");
          } else {
            setMode("hidden");
          }
        }}
      >
        Toggle
      </button>
      <Activity mode={mode}>
        <Swatch />
      </Activity>
    </main>
  );
}
```

View Transition ã¨çµ„ã¿åˆã‚ã›ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã«ãªã‚‹ã‚ã‘ã ãŒã€ `mode` ãŒåˆ‡ã‚Šæ›¿ã‚ã£ãŸã¨ãã®å‰å¾Œã® DOM ã¯å®Ÿã¯ã“ã®ã‚³ãƒ¼ãƒ‰ã¨ã¯å¤§åˆ†ç•°ãªã‚‹æ§˜ç›¸ã‚’ç¤ºã—ã¦ã„ã‚‹ã“ã¨ã«ãªã‚‹ã€‚

```tsx
<ViewTransition>
  <Activity>{children}</Activity>
</ViewTransition>
```

ãã‚‚ãã‚‚ã®ãƒ–ãƒ©ã‚¦ã‚¶ã® View Transition è‡ªä½“ãŒã¨ã£ã¤ãã¥ã‚‰ã„ã¨ã„ã†ã®ã¨ç›¸ã¾ã£ã¦ã€ä½¿ã„ã“ãªã™ã«ã¯æ…£ã‚Œã¨ã„ã†ã‹ã€ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³çš„ãªã‚‚ã®ãŒå¿…è¦ãã†ã€‚

ã¾ãŸã€çµå±€ `Activity` ã«ã©ã†ã„ã†æ°—æŒã§å‘ãåˆã†ã¹ããªã®ã‹ã€è‡ªåˆ†ã®ä¸­ã§ã„ã¾ã„ã¡åˆ†ã‹ã£ã¦ã„ãªã„ã€‚

### View Transition

View Transition ã®æ–¹ã«ã¤ã„ã¦ã¯ã€ä»Šå¹´ã®é ­ã«è»½ãè§¦ã£ã¦ã„ãŸã®ã‚‚ã‚ã£ã¦ãŠã‚ˆãã®æŒ™å‹•ã¯çŸ¥ã£ã¦ã„ãŸã‚‚ã®ã®ã€ãã®æ™‚ç‚¹ã‹ã‚‰ã ã¨ç´°ã‹ã„éƒ¨åˆ†ãŒè‰²ã€…å¤‰ã‚ã£ã¦ã„ãŸã€‚

å€‹äººçš„ã«å¬‰ã—ã•ã‚’è¦šãˆãŸå†…å®¹ã§ã„ã†ã¨ã€`addTransitionType` API ãŒè¿½åŠ ã•ã‚Œã¦ã„ãŸã“ã¨ã€‚
ä»¥ä¸‹ã®ã‚ˆã†ã«ã€Transition ç™ºè¡Œæ™‚ã« View Transition ã«å¯¾ã—ã¦ã€Transition ã®ç¨®åˆ¥ã‚’ãƒãƒ¼ã‚­ãƒ³ã‚°ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚

```tsx
startTransition(() => {
  addTransitionType("forward");
  router.goto(url);
});
```

```tsx
<ViewTransition
  default={{ forward: "slide-right-to-left", back: "slide-left-to-right" }}
>
  {children}
</ViewTransition>
```

ç¢ºã‹å¹´æ˜ã‘ã®æ™‚ç‚¹ã ã¨ã“ã® API ã ã£ãŸã‚Šã€ View Transition ã® `default` ã¨ã„ã† property ã¯å­˜åœ¨ã—ãªã‹ã£ãŸã¯ãšã§ã€`className` ã ã‘ã§æ ¹æ€§ã§é ‘å¼µã‚‹ã‹ã€å®£è¨€çš„ã«æ›¸ãã®ã‚’æ¨ã¦ã¦ ç”Ÿã§ CSS Animation Object ã‚’æ‰‹ç¶šãçš„ã«çµ„ã¿ç«‹ã¦ã¦ View Transition ã«ã‚ãŸã™ãã‚‰ã„ã—ã‹ã§ããªã‹ã£ãŸã€‚

Transition ç™ºç«(= æ‰‹ç¶šãçš„ãªéƒ¨åˆ†) ã¨ View Transition Component(= å®£è¨€çš„ãªéƒ¨åˆ†) ãŒç¨‹ã‚ˆãæ©‹æ¸¡ã•ã‚ŒãŸæ„ŸãŒã‚ã‚‹ã€‚

ä»¥ä¸‹ã¯å¹´æ˜ã‘ã®ã¨ãã«ä½œã£ã¦æ”¾ç½®ã—ã¦ã„ãŸ Demo ã‚’ä»Šå›ã® Blog ã®è¨˜è¿°å†…å®¹ã‚’ã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã•ã›ãŸ PR.

https://github.com/Quramy/next-js-viewtransition-example/pull/3/files

Next.js ç‰¹æœ‰ã®è©±ã«ã¯ãªã‚‹ã‚‚ã®ã®ã€Router ã® Transition ã«å‡¦ç†ã‚’è¿½åŠ ã™ã‚‹ã¨ãªã‚‹ã¨ã€ç¾çŠ¶ã ã¨ `onNavigate` prop ãŒä¸€ç•ªæ¥½ã§ã¯ã‚ã‚‹ã€‚
`router.back()` ã‚„ `router.forward()` ã‚’æ¨ã¦ã‚‹ã“ã¨ã«ãªã‚Šã¯ã™ã‚‹ãŒã€‚ã€‚ã€‚

---

# 4/25

## Next.js ã® Client Segment Cache

https://x.com/acdlite/status/1915477778851651824

ãŠãã‚‰ãã€Router Cache ã®é€²åŒ–ç‰ˆçš„ãªã‚¤ãƒ¡ãƒ¼ã‚¸.

Segment ã® Layout ã¯ Client Side ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚Œã‚‹:

> When prefetching pages with shared structure like:
>
> /store/items/1
> /store/items/2
>
> â€¦the shared layouts (/store/, /items/) are only fetched once.
>
> Shared loading boundaries are de-duped, too.

PPR ã® Static å¢ƒç•Œã‚‚ Cache ã•ã‚Œã‚‹:

> ğŸ§± Built for Partial Prerendering
>
> When PPR is enabled, only the static parts of the page are prefetched, and always from the CDN â€” reducing server load and speeding up requests.
>
> Combined with layout deduping, navigations should feel fast even in slow network conditions.

ã¾ãŸã€Link Component ã® Prefetch Logic ã‚‚æ”¹ä¿®ã•ã‚Œã¦ã„ã‚‹ã¨ã®ã“ã¨:

> Weâ€™ve also improved how prefetches are scheduled:
> â€¢ Links are re-prioritized on hover/touch
> â€¢ Newer links take precedence over older ones
> â€¢ If a link scrolls off-screen, its prefetch is canceled

ãã‚‚ãã‚‚ã€ä»Šã® Link Component ã® Prefetch æ¡ä»¶ã£ã¦ãªã‚“ã ã£ãŸã£ã‘ï¼Ÿ Viewport ã« Intersect ã—ãŸã‚‰ã€ã¨ã‹ã‹ãªï¼Ÿ

> Prefetching happens when a <Link /> component enters the user's viewport (initially or through scroll).

refs: https://nextjs.org/docs/app/api-reference/components/link#prefetch

## View Transition API ã®è¿‘æ³

ã¡ã‚‡ã†ã© Interop 2025 ã®é‡ç‚¹åˆ†é‡ã«å«ã¾ã‚Œã¦ã„ãŸã€‚

https://web.dev/blog/interop-2025?hl=ja#same-document_view_transitions
