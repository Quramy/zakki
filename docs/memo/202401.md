# 1/9

## SWR

swr と Tanstack Query の違い

https://www.ai-shift.co.jp/techblog/3680

個人的には以下が一番衝撃。。。

> SWR では TanStack Query のようにキャッシュの生存期間を設定するオプションはありません。基本的にキャッシュの自動再検証は以下のタイミングで行われます。（これらのオプションは TanStack Query にも共通します。）

## Prisma

Prisma で検索や挿入をする際に、戻り値の SELECT を確実に指定するように強制するような ESLint のプラグインってないのかしら。

React の Taint API と同じ文脈であるが、 `findUser` で取得した JSON がうっかり Client Component に渡ると、User Table の全ての列が RSC Payload に乗ることになる。

```ts
export async function findUser(id: string) {
  return await prisma.user.findUnique({
    where: {
      id,
    },
  });
}
```

```tsx
"use client";

export function User({ user: { name } }: { user: { name: string } }) {
  return <div>{name}</div>;
}
```

上記の例であれば、それこそ React の Taint を使えば防御はできるが、そもそもが `taint` の利用を忘れたら意味がないので、別の防御手段も考えておきたい。

```ts
export async function findUser(id: string) {
  const user = await prisma.user.findUnique({
    id,
  });
  taint("Don't pass this object to clinet component", user);
  return user;
}
```

Prisma の API 実行時点で SELECT する対象を明示するようにできれば、事故防止になるんじゃないか？という発想。

```ts
export async function findUser(id: string) {
  return await prisma.user.findUnique({
    select: { name: true },
    where: {
      id,
    },
  });
}
```

適当に "prisma eslint plugin" などで検索してみたが、それっぽいものは見つからず。

## Accounts.js

The Guild の Blog を巡回している最中に見つけた。

https://the-guild.dev/blog/accounts.js-1.0-rc

Alt Passport 的な感じのライブラリかしら？

## Misc

2 週間程度休んでいたので、今日から仕事はじめ。
