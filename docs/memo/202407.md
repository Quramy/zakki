# 7/2

## Netflix の GraphQL 移行

https://netflixtechblog.com/migrating-netflix-to-graphql-safely-8e1e4d4f1e72

これは 2023 年に公開された記事だけど、まだ Falcor が生き残っていたらしい。

> Until recently, an internal API framework, Falcor, powered our mobile apps. They are now backed by Federated GraphQL, a distributed approach to APIs where domain teams can independently manage and own specific sections of the API.

## prisma-fabbrica と TypeScript compile error 地獄再び

v2.2.0 リリース後、初の Issue 報告が。

https://github.com/Quramy/prisma-fabbrica/issues/349

懸念していた「俺の環境だと TypeScript で Compilation Error 出る」系。

原因自体は大したことはなくて、 `--noUncheckedIndexedAccess` を有効にしてない状態で artifact の確認をしていたせいでしかないので、シュッと直せたんだけど、特定の tsc オプションで牙をむいてくる系、モグラ叩きじみてきた。

Generator の `noTranspile` オプションを公開したのが間違いだったのかなぁ。。

---

# 7/3

## TypeScript と Arbitrary Module Namespace Identifier

5.6 マイルストンで何か面白そうな PR 無いかなと思って眺めていたところ、 https://github.com/microsoft/TypeScript/pull/58640 を見つけた。

```js
import { "Foo::new" as Foo_new } from "./foo.wasm";

const foo = Foo_new();

export { Foo_new as "Foo::new" };
```

ECMA としては ES2022 で利用可能になった Spec らしい。https://github.com/tc39/ecma262/pull/2154

上記は WebAssembly での例だが、他にも Type Assertion 付きで Web Component を import するなどのパターンもあるみたい。

```js
import {'product-card' as productCard} from './product.html` with {type: 'html'};
```

(正直マニアック過ぎて思いつきもしなかったけど。。。)

---

# 7/9

## Next.js の Server Action の公開範囲について

`"use server"` をモジュールトップに付与している場合、そこで export したすべての関数が SA として実行可能になってしまうよ、という件。

https://zenn.dev/moozaru/articles/b0ef001e20baaf

## Timee におけるチームトポロジーの解釈と実践について

書籍の Team Topologies に即して資料が書いてありつつ、Timee における Enabling チームの例などが記載されていてわかりやすい。

https://speakerdeck.com/go0517go/practical-team-topologies-in-timee

## Wiz と Angular, そして Qwik の関係

暇なので前々から名前だけ聞いていた Wiz について調べる。

## そもそもの Wiz について

そもそも OSS ではないとのことなので、情報があまりないが、以下の Zenn の記事が程よくサマってくれていそう。

https://zenn.dev/tomoam/scraps/347e9ebc0d9d45

> Wiz は latency sensible なコンシューマー向けに
> Angular は highly interactive なエンタープライズ向けに
> Wiz と Angular はお互いの機能(← 特徴のほうが適切かも)を求め合っていた
>
> 昨年、Angular 側が Signal Primitive を開発しようとしてしていたときに、Wiz 側も同じことをしようとしていた
>
> それなら、共有してはどうだろう
> 小さいプロダクトからやってみよう
>
> YouTube （← さすが、ユーモアを忘れない）
> すでに YouTube では Angular Signals が使われている
>
> Angular が Wiz と合体するというより、Angular Signals が Wiz に採用された、ということみたいです。

### Angular と Wiz

Angular がオフィシャルに Wiz について言及している資料としては以下:

https://blog.angular.dev/angular-and-wiz-are-better-together-91e633d8cd5a

"What is Wiz?" セクションに、以下のようにあり、確かに上記の Zenn で紹介されている内容とも一致している。

> Millions of users access large Google applications over slow networks and/or low-end devices. In such cases initial load latency and amount of JavaScript matters a lot. The Wiz framework meets these requirements in a couple of ways.

さらに、以下のとおりに続く:

> Wiz always starts with server-side rendering. Everything on the page, including interactive components, is rendered on a highly optimizing streaming solution.

Angular が基本的に SPA を作るためのフレームワークであるのに対して、 Wiz は MPA (SSR) ファーストなフレームワーク。

現状では、Angular Signals が Wiz で使われている程度のコラボレーション具合ではあるが、

> Our long-term goal is to gradually and responsibly merge Angular and Wiz over the coming years. Our strategy is to steadily open source Wiz features via Angular and follow our open model of development, allowing the community to both influence the roadmap and plan accordingly.

最終的には(かなり時間を要するだろうが) Angular / Wiz を統合したフレームワークにしたい、とのこと。

まぁでも Angular も出たての頃は Web Components を一級市民として云々、とか言ってたけど結局そうはなっていないし、Closure Compiler との統合、みたいな話も結局どこにいったのやらだし、壮大な計画として話半分くらいに考えておくのがいいのかもしれない。

### Qwik と Wiz

SSR ファーストな MPA FW で Signal 依存、という意味では Wiz と Qwik はかなり近しい存在だが、Qwik の親 (そして Angular の父でもある) Misko Hevery は以下のように言っている。

> While @QwikDev is inspired by Wiz, there are 3 innovations over Wiz:
>
> 1. DX of Qwik is miles ahead;
> 1. Qwik Optimizer decomposes your nested closures into lazy loadable chunks;
> 1. Lazy loading of Qwik is much more fine-grained than that of Wiz.
>
> [standing on shoulders of giants]

https://x.com/mhevery/status/1482011184039534597

Misko の Google 時代に多いにインスパイアされてはいそうだけど、クロージャ周りの取り扱いなどは Qwik の方が後発だけあって洗練された仕組みを持っているとのこと。

https://www.youtube.com/watch?v=CEwYK6qamco の動画で Misko 自身が Qwik を始めた経緯を語っているが、やっぱり 「Google の社内外で思ったより Angular が普及しなかったこと」が根底にあるように思えた。
(動画中で Angular を下げるような発言をしているわけではないけども)
