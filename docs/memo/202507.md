# 7/1

## HTML 属性から CSS Custom Properties を参照する

```css
:root {
  --color: red;
}
```

要素の属性としていきなり Custom Properties を参照したくなるケースなんてそんなにないのだけど、SVG などではそこそこに発生する。

```html
<svg><circle fill="var(--color)" /></svg>
```

`currentColor` を使うということは今まで当たり前にやっていたので、まぁそれの応用みたいなものと思えばそんなに驚くほどのことじゃないかもしれないが、もっと早くしっておけばよかった。

---

# 7/7

## dialog 要素と React

HTML Dialog の `showModal`, どうも React 上で管理するのが不向きな感があるな。

Dialog 要素が DOM ツリー上にあるかどうかは普通に React で管理できるけど、Dialog が表示されているかどうか、いわゆる `open` 属性的な部分については宣言的な管理がとてもやりにくい。

そもそも Dialog の open 属性は非推奨属性なので、HTMLDialogElement の `show` や `showModal` メソッドを使うことになるわけだけど、メソッドを利用する時点で宣言的な手法と相性が悪い気がする。

---

# 7/8

## dialog 要素と jsdom

引き続き dialog 要素周り。

```tsx
function MyModalDialogWrapper() {
  const ref = useRef();
  return (
    <>
      <button onClick={() => ref.current?.showModal()}>Open Dialog</button>
      <dialog ref={ref}>content</dialog>
    </>
  );
}
```

```ts
test("open modal dialog", async () => {
  render(<MyModalDialogWrapper />);

  await userEvent.click(screen.getByRole("button", { name: "Open Dialog" })); // <= ここで jsdom error
});
```

Throw される Error の内容は以下の通り。要するに jsdom では `showModal` や `close` などの HTMLDialogElement 固有のメソッドが実装されていない。

```
    Error: Uncaught [TypeError: _ref_current.showModal is not a function]
        at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
```

https://github.com/jsdom/jsdom/issues/3294
